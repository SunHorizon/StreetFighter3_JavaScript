
<html>
<head>
	<meta charset="utf-8">
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
	<script type="text/javascript">
		$(document).ready(function(){
			var canvas = $("#myCanvas");
			var context = canvas.get(0).getContext("2d");

			var CheckChoice = false;
			var buttonPress = false;
			var checkCharacter;
			var AICharacter;

			if(CheckChoice == false){
						// player icon image
						var player = new Image();
								player.src = "Player.png";
								player.onload = function(){
								context.drawImage(player,0,0,900,120, 5,5,200,150);
								};
							// VS icon image
							var vs = new Image();
									vs.src = "VS.png";
									vs.onload = function(){
									context.drawImage(vs,0,0,300,250, 200,5,200,150);
										};
							// CPU icon image
							var cpu = new Image();
										cpu.src = "CPU.png";
										cpu.onload = function(){
										context.drawImage(cpu,0,0,600,500, 360,5,200,150);
										};

									// get Mouse Coordinates
									var mouseX = 0;
							    var mouseY = 0;


									// Ryu icon object
									var Ryu = {
											image: "RyuIcon.jpg",
									    sourceX: 400,
											sourceY: 200,
											sourceWidth: 64,
											sourceHeight: 64,

											 //Getters to define the left, right, top and bottom sides, these functions are use to get the parameter of our shape in order to determine whether our mouse falls within

									    left: function() { return this.sourceX; },
											right: function() { return (this.sourceX + this.sourceWidth); },
										  top: function() { return this.sourceY; },
									    bottom: function() { return (this.sourceY + this.sourceHeight); }
							  };

								var Sean = {
										image: "SeanIcon.png",
										sourceX: 400,
										sourceY: 300,
										sourceWidth: 64,
										sourceHeight: 64,

										 //Getters to define the left, right, top and bottom sides, these functions are use to get the parameter of our shape in order to determine whether our mouse falls within

										left: function() { return this.sourceX; },
										right: function() { return (this.sourceX + this.sourceWidth); },
										top: function() { return this.sourceY; },
										bottom: function() { return (this.sourceY + this.sourceHeight); }
							};



									// ChunLi icon object
									var ChunLi = {
												image: "Chun-Li_Icon.jpeg",
						            sourceX: 50,
						            sourceY: 200,
						            sourceWidth: 64,
						            sourceHeight: 64,

						            //Getters to define the left, right, top and bottom sides, these functions are use to get the parameter of our shape in order to determine whether our mouse falls within

						              left: function() { return this.sourceX; },
						              right: function() { return (this.sourceX + this.sourceWidth); },
						              top: function() { return this.sourceY; },
						              bottom: function() { return (this.sourceY + this.sourceHeight); }
						          };

											// Makoto icon object
									var Makoto = {
													image: "MakotoIcon.jpg",
													sourceX: 50,
													sourceY: 300,
													sourceWidth: 64,
													sourceHeight: 64,

													//Getters to define the left, right, top and bottom sides, these functions are use to get the parameter of our shape in order to determine whether our mouse falls within

														left: function() { return this.sourceX; },
												  	right: function() { return (this.sourceX + this.sourceWidth); },
														top: function() { return this.sourceY; },
														bottom: function() { return (this.sourceY + this.sourceHeight); }
													};


											// get the  ChunLi image
											var ChunLiImage = new Image();
											ChunLiImage.addEventListener("load", render, false);
											ChunLiImage.src = ChunLi.image;

											// get the  Makoto image
											var MakotoImage = new Image();
											MakotoImage.addEventListener("load", render, false);
											MakotoImage.src = Makoto.image;

											// get the  Ryu image
											var RyuImage = new Image();
											RyuImage.addEventListener("load", render, false);
											RyuImage.src = Ryu.image;

											// get the  Makoto image
											var SeanImage = new Image();
											SeanImage.addEventListener("load", render, false);
											SeanImage.src = Sean.image;




										// Check for input from keyboard
											window.addEventListener("keydown", keydownHandler, false);

											//Add a mousemove event listener
											  window.addEventListener("mousemove", function(event)
											   {
											        //Find the mouse's X and Y positions of our mouse movement
																				 mouseX = event.pageX ;
											                   mouseY = event.pageY ;
											                   //console.log(mouseX + " " + mouseY);
											                   //keep calling the update function and update canvas object on each movement
											                   // requestAnimationFrame(update, canvas);
																				 if(CheckChoice == false){
																					 update();
																			 }
									        }, false);

												//this test whether there is a collision, mouse x/y coordinates fall within the parameter of our shape
													function hitTestPoint(pointX, pointY) {
												                    var hit = false;
																						checkCharacter = 0;
																						//chun li
												                    if(pointX > ChunLi.left()
												                    && pointX < ChunLi.right()
												                    && pointY > ChunLi.top()
												                    && pointY < ChunLi.bottom())
												                    {
																							hit = true;
																							checkCharacter = 1;
																							AICharacter = 1;
																						}
																						//makoto
																						if(pointX > Makoto.left()
																					 && pointX < Makoto.right()
																					 && pointY > Makoto.top()
																					 && pointY < Makoto.bottom())
																					 {
																						 hit = true;
																						 checkCharacter = 2;
																						 AICharacter = 2;
																					 }
																				/*	 //ryu
																					 if(pointX > Ryu.left()
																					&& pointX < Ryu.right()
																					&& pointY > Ryu.top()
																					&& pointY < Ryu.bottom())
																					{
																						hit = true;
																						checkCharacter = 3;
																					}
																					//Sean
																					if(pointX > Sean.left()
																				 && pointX < Sean.right()
																				 && pointY > Sean.top()
																				 && pointY < Sean.bottom())
																				 {
																					 hit = true;
																					 checkCharacter = 4;
																				 }*/
												                        return hit;

										 }

										// Checking for key press
										function keydownHandler(event) {
													switch (event.keyCode) {
														// press p
													case 	80:
															buttonPress = true;
															update();
														break;
													}
										}

						   			  function update()
										  {
									        //The animation loop
													//Use hitTestPoint to check for a collision and
									        //return the result (true or false) to the collision variable
													   if(hitTestPoint(mouseX, mouseY))
													  {
																// if button press = true and mouse collision
																	if(buttonPress == true){
																		CheckChoice = true;
																		// run the play function
																		message = checkCharacter;
																		Play(CheckChoice,checkCharacter, AICharacter);
																		console.log(message);
																 	}
												    }
											      else {
																buttonPress = false;
														}
													  //Render the sprite object
															 render();
									 }

								// render the image
									function render()
	               {
										//Draw ChunLi
										context.drawImage(ChunLiImage,
										ChunLi.sourceX, ChunLi.sourceY,
	                  ChunLi.sourceWidth, ChunLi.sourceHeight);

										//Draw Makoto
										context.drawImage(MakotoImage,
										Makoto.sourceX, Makoto.sourceY,
	                  Makoto.sourceWidth, Makoto.sourceHeight);

										//Draw Ryu
										context.drawImage(RyuImage,
										Ryu.sourceX, Ryu.sourceY,
	                  Ryu.sourceWidth, Ryu.sourceHeight);

										//Draw Sean
										context.drawImage(SeanImage,
										Sean.sourceX, Sean.sourceY,
										Sean.sourceWidth, Sean.sourceHeight);
								}

						};

function Play(CheckChoice,checkCharacter, AICharacter){
			if(CheckChoice == true){
				context.clearRect(0,0,605,800);

			var CharacterSprite=
			{
				health:100,
				hitting:0,
				standing:0,
				crouching:1,
				jumping:2,
				punching:3,
				kicking:4,
				charging:5,

				posx:0,
				posy:340,
				state:0
			};

			var AISprite=
			{
				health:100,
				hitting:0,
				standing:0,
				crouching:3,
				jumping:4,
				punching:1,
				kicking:2,
				charging:5,

				posx:600,
				posy:340,
				state:0
			};

			var healthPlayer = new Image();
				healthPlayer.src = "gokuhealth.png";
				healthPlayer.addEventListener("load",render,false);

		var healthAI = new Image();
		  	healthAI.src = "gokuhealth.png";
				healthAI.addEventListener("load",render,false);

			var background = new Image();
				background.src = "background.png";
				background.onload = function(){
				context.drawImage(background,0,0);
				};

			if(checkCharacter == 1){
					var CharacterLiImage = new Image();
					CharacterLiImage.addEventListener("load", render, false);
					CharacterLiImage.src = "Chun-Li.png";
			}

			if(checkCharacter == 2){
				var CharacterLiImage = new Image();
				CharacterLiImage.addEventListener("load", render, false);
				CharacterLiImage.src = "Makoto.png";
		}

		if(AICharacter == 1){
			var AIImage = new Image();
			AIImage.addEventListener("load", render, false);
			AIImage.src = "RyuRight.png";
	}

	if(AICharacter == 2){
		var AIImage = new Image();
		AIImage.addEventListener("load", render, false);
		AIImage.src = "SeanRight.png";
}

			window.addEventListener("keydown", keydownHandler, false);
			window.addEventListener("keyup",keyupHandler,false);
			render();
			function keyupHandler() {
					context.clearRect(0,0,605,800);
					CharacterSprite.state = CharacterSprite.standing;
					AISprite.state = AISprite.standing;
					context.drawImage(background,0,0);
					render();
			}


			function hitDetection1(){

					if(CharacterSprite.hitting==3){
							CharacterSprite.health+=10
							if(CharacterSprite.health>100){
									CharacterSprite.health = 100;
							}
					}
				// if(goku2.posx-goku.posx<=40)
				// {
				// 		if(goku.hitting == 1){
				// 		goku2.health= goku2.health -= 10;
				// 		}
				// 		else if(goku.hitting ==2){
				// 		goku2.health -=20;
				// 		}
				//
				// }
				// if(goku2.health<=0){
				// 		alert("player1 won");
				// 		goku2.posx = 400;
				// 		goku2.health= 100
				// 		goku.posx = 0;
				// 		goku.health = 100;
				// 		goku.state = goku.standing;
				// 		goku2.state = goku2.standing;
				// 		render();
				//
				// }
				CharacterSprite.hitting = 0;
			}

			function keydownHandler(event) {

                switch (event.keyCode) {
									// press q to punch
                case 81:
									 	CharacterSprite.state = CharacterSprite.punching;
						       	CharacterSprite.hitting = 1;
										//var a = Math.floor((Math.random() * 2) + 1);
										//AISprite.state = a;
										hitDetection1();
                  break;

								// press w to kick
              	case 87:
										CharacterSprite.state = CharacterSprite.kicking;
										CharacterSprite.hitting = 2;
										hitDetection1();
            			break;

								// press e to block
                case 69:
										CharacterSprite.state = CharacterSprite.block;
										CharacterSprite.hitting = 3;
										hitDetection1();
                  break;

									// right arrow key to go right
								case 39:	//right
											CharacterSprite.posx+=10;
											if(CharacterSprite.posx >=600){
											CharacterSprite.posx = 600;
											}
											AISprite.posx-=10;
											if(AISprite.posx <=0){
											AISprite.posx = 0;
											}
											render();
											break;

								// left arrow key to go left
								case 37:	//left
											CharacterSprite.posx-=10;
											if(CharacterSprite.posx <=0 ){
											CharacterSprite.posx= 0;
											}
											AISprite.posx+=10;
											if(AISprite.posx >=600){
											AISprite.posx = 600;
											}

											render();
											break;

                }
				context.clearRect(0,0,605,800);
				context.drawImage(background,0,0);
				render();
			}

			function render() {
			//health bars
			if(CharacterSprite.health>90)
			{context.drawImage(healthPlayer,12, 12, 275, 25, 10,10,270,15);}
			else if(CharacterSprite.health==90)
			{context.drawImage(healthPlayer,12, 40, 275, 25, 10,10,270,15);}
			else if(CharacterSprite.health==80)
			{context.drawImage(healthPlayer,12, 68, 275, 25, 10,10,270,15);}
			else if(CharacterSprite.health==70)
			{context.drawImage(healthPlayer,12, 92, 275, 25, 10,10,270,15);}
			else if(CharacterSprite.health==60)
			{context.drawImage(healthPlayer,12, 123, 275, 25, 10,10,270,15);}
			else if(CharacterSprite.health==50)
			{context.drawImage(healthPlayer,12, 151, 275, 25, 10,10,270,15);}
			else if(CharacterSprite.health==40)
			{context.drawImage(healthPlayer,12, 179, 275, 25, 10,10,270,15);}
			else if(CharacterSprite.health==30)
			{context.drawImage(healthPlayer,12, 207, 275, 25, 10,10,270,15);}
			else if(CharacterSprite.health==20)
			{context.drawImage(healthPlayer,12, 235, 275, 25, 10,10,270,15);}
			else if(CharacterSprite.health==10)
			{context.drawImage(healthPlayer,12, 263, 275, 25, 10,10,270,15);}
			else if(CharacterSprite.health==0)
			{context.drawImage(healthPlayer,12, 291, 275, 25, 10,10,270,15);}

			//Enemy health bar
			if(AISprite.health>90)
			{context.drawImage(healthAI,12, 12, 275, 25, 490,10,270,15);}
			else if(AISprite.health==90)
			{context.drawImage(healthAI,12, 40, 275, 25, 10,10,270,15);}
			else if(AISprite.health==80)
			{context.drawImage(healthAI,12, 68, 275, 25, 10,10,270,15);}
			else if(AISprite.health==70)
			{context.drawImage(healthAI,12, 92, 275, 25, 10,10,270,15);}
			else if(AISprite.health==60)
			{context.drawImage(healthAI,12, 123, 275, 25, 10,10,270,15);}
			else if(AISprite.health==50)
			{context.drawImage(healthAI,12, 151, 275, 25, 10,10,270,15);}
			else if(AISprite.health==40)
			{context.drawImage(healthAI,12, 179, 275, 25, 10,10,270,15);}
			else if(AISprite.health==30)
			{context.drawImage(healthAI,12, 207, 275, 25, 10,10,270,15);}
			else if(AISprite.health==20)
			{context.drawImage(healthAI,12, 235, 275, 25, 10,10,270,15);}
			else if(AISprite.health==10)
			{context.drawImage(healthAI,12, 263, 275, 25, 10,10,270,15);}
			else if(AISprite.health==0)
			{context.drawImage(healthAI,12, 291, 275, 25, 10,10,270,15);}


				//ChunLi positions and states
				if(checkCharacter == 1){
						switch(CharacterSprite.state) {
							case CharacterSprite.standing:
								context.drawImage(
									 CharacterLiImage,
									 0, 0, 85, 115,
									 CharacterSprite.posx, CharacterSprite.posy, 150, 150
								 );
								break;

							case CharacterSprite.punching:
									context.drawImage(
											CharacterLiImage,
											228, 0, 200, 120,
											CharacterSprite.posx, CharacterSprite.posy, 150, 150
										);
											break;
							case CharacterSprite.kicking:
									context.drawImage(
										CharacterLiImage,
										85, 0, 155, 100,
										CharacterSprite.posx, CharacterSprite.posy, 150, 150
									 );
										break;
							case CharacterSprite.block:
								  context.drawImage(
										CharacterLiImage,
										430, 0, 100, 120,
										CharacterSprite.posx, CharacterSprite.posy, 150, 150
									);
										break;
							}
				}

			if(checkCharacter == 2){
						// Makoto positions and states
						switch(CharacterSprite.state) {
							case CharacterSprite.standing:
								context.drawImage(
									 CharacterLiImage,
									 0, 0, 110, 115,
									 CharacterSprite.posx, CharacterSprite.posy, 150, 150
								 );
								break;

							case CharacterSprite.punching:
									context.drawImage(
											CharacterLiImage,
											255, 0, 180, 120,
											CharacterSprite.posx, CharacterSprite.posy, 150, 150
										);
											break;
							case CharacterSprite.kicking:
									context.drawImage(
										CharacterLiImage,
										110, 0, 155, 100,
										CharacterSprite.posx, CharacterSprite.posy, 150, 150
									 );
										break;
							case CharacterSprite.block:
									context.drawImage(
										CharacterLiImage,
										430, 0, 100, 120,
										CharacterSprite.posx, CharacterSprite.posy, 150, 150
									);
										break;
							}
				}
				//Ryu
				if(AICharacter == 1){
							// Makoto positions and states
							switch(CharacterSprite.state) {
								case CharacterSprite.standing:
									context.drawImage(
										 AIImage,
										 169, 0, 91, 160,
										 AISprite.posx, AISprite.posy, 150, 150
									 );
									break;

								case CharacterSprite.punching:
										context.drawImage(
												AIImage,
												433, 0, 122, 160,
												AISprite.posx, AISprite.posy, 150, 150
											);
												break;
								case CharacterSprite.kicking:
										context.drawImage(
											AIImage,
											0, 0, 120, 160,
											AISprite.posx, AISprite.posy, 150, 150
										 );
											break;
								case CharacterSprite.block:
										context.drawImage(
											AIImage,
											316, 0, 82, 160,
											AISprite.posx, AISprite.posy, 150, 150
										);
											break;
								}
					}
					//Ryu
					if(AICharacter == 2){
								// Makoto positions and states
								switch(CharacterSprite.state) {
									case CharacterSprite.standing:
										context.drawImage(
											 AIImage,
											 0, 0, 80, 160,
											 AISprite.posx, AISprite.posy, 150, 150
										 );
										break;

									case CharacterSprite.punching:
											context.drawImage(
													AIImage,
													216, 0, 128, 160,
													AISprite.posx, AISprite.posy, 150, 150
												);
													break;
									case CharacterSprite.kicking:
											context.drawImage(
												AIImage,
												370, 0, 144, 160,
												AISprite.posx, AISprite.posy, 150, 150
											 );
												break;
									case CharacterSprite.block:
											context.drawImage(
												AIImage,
												106, 0, 84, 160,
												AISprite.posx, AISprite.posy, 150, 150
											);
												break;
									}
						}

		}
	}
}
		});
	</script>
</head>
<body>

	<canvas id="myCanvas" height="605" width="800"></canvas>

</body>
</html>
